{"version":3,"file":"commonHelpers.js","sources":["../src/js/unsplash-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\naxios.defaults.baseURL = 'https://api.unsplash.com';\n\nconst API_KEY = 'LxvKVGJqiSe6NcEVZOaLXC-f2JIIWZaq_o0WrF8mwJc';\nconst END_POINT = '/search/photos';\n\n// export function getPhotos(query) {\n//   const params = new URLSearchParams({\n//     query,\n//     page: 1,\n//     per_page: 12,\n//     orientation: 'portrait',\n//     client_id: API_KEY,\n//   });\n//   return fetch(`${BASE_URL}${END_POINT}/?${params}`).then(res => {\n//     if (!res.ok) {\n//       throw new Error(res.status);\n//     }\n//     return res.json();\n//   });\n// }\n\nexport const userParams = {\n  page: 1,\n  searchQuery: null,\n  perPage: 12,\n};\n\nexport const getPhotos = () => {\n  return axios.get(`${END_POINT}`, {\n    params: {\n      query: userParams.searchQuery,\n      page: userParams.page,\n      per_page: userParams.perPage,\n      orientation: 'portrait',\n      client_id: API_KEY,\n    },\n  });\n};\n","export const renderMarkup = arr => {\n  return arr\n    .map(\n      ({ urls, description }) => `<li class=\"gallery__item\">\n        <img src=\"${urls.small}\" alt=\"${description}\">\n    </li>`\n    )\n    .join('');\n};\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getPhotos, userParams } from './js/unsplash-api';\nimport { renderMarkup } from './js/render-functions';\n\nconst gallery = document.querySelector('.js-gallery');\nconst form = document.querySelector('.js-search-form');\nconst loader = document.querySelector('.js-loader');\nconst loadMoreBtn = document.querySelector('.js-load-more');\n\niziToast.settings({\n  progressBar: false,\n  timeout: 4000,\n  resetOnHover: true,\n  icon: 'material-icons',\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n  position: 'topRight',\n});\n\nconst showLoader = () => {\n  loader.classList.remove('is-hidden');\n};\n\nconst hideLoader = () => {\n  loader.classList.add('is-hidden');\n};\n\nconst showBtn = () => {\n  loadMoreBtn.classList.remove('is-hidden');\n};\n\nconst hideBtn = () => {\n  loadMoreBtn.classList.add('is-hidden');\n};\n\nconst onSubmit = async e => {\n  e.preventDefault();\n  gallery.innerHTML = '';\n  userParams.page = 1;\n  showLoader();\n\n  userParams.searchQuery =\n    e.currentTarget.elements['user-search-query'].value.trim();\n\n  if (userParams.searchQuery === '') {\n    return alert('Empty query');\n  }\n\n  try {\n    const { data } = await getPhotos();\n\n    if (data.results.length === 0) {\n      hideBtn();\n      return iziToast.warning({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n    }\n\n    iziToast.info({\n      message: `We found ${data.total} photos`,\n    });\n\n    gallery.innerHTML = renderMarkup(data.results);\n    if (data.total > userParams.perPage) {\n      showBtn();\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    e.target.reset();\n    hideLoader();\n  }\n\n  //   getPhotos(searchQuery)\n  //     .then(({ data }) => {\n  //       if (data.results.length === 0) {\n  //         return alert(\n  //           'Sorry, there are no images matching your search query. Please try again!'\n  //         );\n  //       }\n\n  //       alert(`We found ${data.total} photos`);\n  //       gallery.innerHTML = renderMarkup(data.results);\n  //     })\n  //     .catch(error => console.log(error))\n  //     .finally(() => {\n  //       e.target.reset();\n  //       hideLoader();\n  //     });\n};\n\nconst onClick = async e => {\n  userParams.page += 1;\n  showLoader();\n  try {\n    const { data } = await getPhotos();\n    gallery.insertAdjacentHTML('beforeend', renderMarkup(data.results));\n\n    // Функція для скролл.\n\n    const { height: cartHeight } = document\n      .querySelector('.js-gallery')\n      .firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n      top: cartHeight * 2,\n      behavior: 'smooth',\n    });\n\n    // Пошук останньої сторінки.\n\n    const lastPage = Math.ceil(data.total / userParams.perPage);\n    if (lastPage === userParams.page) {\n      hideBtn();\n\n      iziToast.info({\n        message: `We're sorry, but you've reached the end of search results.`,\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader();\n  }\n};\n\nform.addEventListener('submit', onSubmit);\n\nloadMoreBtn.addEventListener('click', onClick);\n"],"names":["axios","API_KEY","END_POINT","userParams","getPhotos","renderMarkup","arr","urls","description","gallery","form","loader","loadMoreBtn","iziToast","showLoader","hideLoader","showBtn","hideBtn","onSubmit","e","data","error","onClick","cartHeight"],"mappings":"6vBACAA,EAAM,SAAS,QAAU,2BAEzB,MAAMC,EAAU,8CACVC,EAAY,iBAkBLC,EAAa,CACxB,KAAM,EACN,YAAa,KACb,QAAS,EACX,EAEaC,EAAY,IAChBJ,EAAM,IAAI,GAAGE,CAAS,GAAI,CAC/B,OAAQ,CACN,MAAOC,EAAW,YAClB,KAAMA,EAAW,KACjB,SAAUA,EAAW,QACrB,YAAa,WACb,UAAWF,CACZ,CACL,CAAG,ECrCUI,EAAeC,GACnBA,EACJ,IACC,CAAC,CAAE,KAAAC,EAAM,YAAAC,CAAW,IAAO;AAAA,oBACbD,EAAK,KAAK,UAAUC,CAAW;AAAA,UAE9C,EACA,KAAK,EAAE,ECDNC,EAAU,SAAS,cAAc,aAAa,EAC9CC,EAAO,SAAS,cAAc,iBAAiB,EAC/CC,EAAS,SAAS,cAAc,YAAY,EAC5CC,EAAc,SAAS,cAAc,eAAe,EAE1DC,EAAS,SAAS,CAChB,YAAa,GACb,QAAS,IACT,aAAc,GACd,KAAM,iBACN,aAAc,UACd,cAAe,WACf,SAAU,UACZ,CAAC,EAED,MAAMC,EAAa,IAAM,CACvBH,EAAO,UAAU,OAAO,WAAW,CACrC,EAEMI,EAAa,IAAM,CACvBJ,EAAO,UAAU,IAAI,WAAW,CAClC,EAEMK,EAAU,IAAM,CACpBJ,EAAY,UAAU,OAAO,WAAW,CAC1C,EAEMK,EAAU,IAAM,CACpBL,EAAY,UAAU,IAAI,WAAW,CACvC,EAEMM,EAAW,MAAMC,GAAK,CAS1B,GARAA,EAAE,eAAc,EAChBV,EAAQ,UAAY,GACpBN,EAAW,KAAO,EAClBW,IAEAX,EAAW,YACTgB,EAAE,cAAc,SAAS,mBAAmB,EAAE,MAAM,OAElDhB,EAAW,cAAgB,GAC7B,OAAO,MAAM,aAAa,EAG5B,GAAI,CACF,KAAM,CAAE,KAAAiB,CAAI,EAAK,MAAMhB,IAEvB,GAAIgB,EAAK,QAAQ,SAAW,EAC1B,OAAAH,IACOJ,EAAS,QAAQ,CACtB,QACE,0EACV,CAAO,EAGHA,EAAS,KAAK,CACZ,QAAS,YAAYO,EAAK,KAAK,SACrC,CAAK,EAEDX,EAAQ,UAAYJ,EAAae,EAAK,OAAO,EACzCA,EAAK,MAAQjB,EAAW,SAC1Ba,GAEH,OAAQK,EAAO,CACd,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACRF,EAAE,OAAO,QACTJ,GACD,CAkBH,EAEMO,EAAU,MAAMH,GAAK,CACzBhB,EAAW,MAAQ,EACnBW,IACA,GAAI,CACF,KAAM,CAAE,KAAAM,CAAI,EAAK,MAAMhB,IACvBK,EAAQ,mBAAmB,YAAaJ,EAAae,EAAK,OAAO,CAAC,EAIlE,KAAM,CAAE,OAAQG,CAAU,EAAK,SAC5B,cAAc,aAAa,EAC3B,kBAAkB,sBAAqB,EAE1C,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QAChB,CAAK,EAIgB,KAAK,KAAKH,EAAK,MAAQjB,EAAW,OAAO,IACzCA,EAAW,OAC1Bc,IAEAJ,EAAS,KAAK,CACZ,QAAS,4DACjB,CAAO,EAEJ,OAAQQ,EAAO,CACd,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACRN,GACD,CACH,EAEAL,EAAK,iBAAiB,SAAUQ,CAAQ,EAExCN,EAAY,iBAAiB,QAASU,CAAO"}